const getDate = require('./date');
const { getCutText, textLimitTypes } = require('./cut-text');

module.exports = async (ctx, wish, owner = true, onlyTitleAndDate = false) => {
    if (!wish) return '';

    const created = getDate(ctx, wish.createdAt);
    const updated = getDate(ctx, wish.updatedAt);
    const showEditDate = created !== updated;
    const editDate = showEditDate ? `\nüóì _–û–Ω–æ–≤–ª–µ–Ω–æ: ${updated}_` : '';
    const createdDate = `\n\nüóì _–°—Ç–≤–æ—Ä–µ–Ω–æ: ${created}_`;
    const title = `‚ù§Ô∏è *${getCutText(wish.title)}*`;

    if (onlyTitleAndDate) {
        return title + (editDate ? `\n${editDate}` : createdDate);
    }

    let priority = '';
    const description = wish.description
        ? `\n\n‚úèÔ∏è –û–ø–∏—Å:\n${getCutText(
              wish.description,
              textLimitTypes.DESCRIPTION
          )}`
        : '';

    if (wish.priority) {
        priority = owner
            ? '\n\n‚ùóÔ∏è *–ù–∞—Ä–∞–∑—ñ –¥—É–∂–µ —Ö–æ—á—É —Ü–µ!*'
            : '\n\n‚ùóÔ∏è *–ù–∞—Ä–∞–∑—ñ –¥—É–∂–µ —Ö–æ—á–µ —Ü–µ!*';
    }

    return title + priority + description + createdDate + editDate;
};
